<div class="forgot-password-container">
  <div class="forgot-password-card">
    <!-- Step 1: Enter Email -->
    <div *ngIf="currentStep() === 'email'">
      <h2>Forgot Password</h2>
      <p class="subtitle">Enter your email to receive a verification code</p>
      
      <form (ngSubmit)="onRequestOtp()">
        <div class="form-group">
          <label for="email">Email Address *</label>
          <input 
            type="email" 
            id="email" 
            [(ngModel)]="email" 
            name="email" 
            required
            [disabled]="isLoading"
            placeholder="your@email.com"
            autocomplete="email">
        </div>
        
        <div *ngIf="error" class="error">❌ {{error}}</div>
        <div *ngIf="success" class="success">✅ {{success}}</div>
        
        <button 
          type="submit" 
          [disabled]="isLoading || !email"
          class="submit-btn">
          {{isLoading ? 'Sending Code...' : 'Send Verification Code'}}
        </button>
      </form>
      
      <p class="back-link">
        <a routerLink="/login">← Back to Login</a>
      </p>
    </div>

    <!-- Step 2: Verify OTP -->
    <div *ngIf="currentStep() === 'otp'">
      <button class="back-btn" (click)="backToEmail()">← Back</button>
      
      <app-otp-input
        [title]="'Verify Your Email'"
        [description]="'We sent a 6-digit code to ' + email"
        [expirySeconds]="600"
        [resendDelay]="60"
        (verify)="onVerifyOtp($event)"
        (resend)="onResendOtp()"
      ></app-otp-input>
      
      <div *ngIf="success" class="success-banner">✅ {{success}}</div>
    </div>

    <!-- Step 3: Reset Password -->
    <div *ngIf="currentStep() === 'reset'">
      <button class="back-btn" (click)="backToOtp()">← Back</button>
      
      <h2>Set New Password</h2>
      <p class="subtitle">Enter your new password below</p>
      
      <form (ngSubmit)="onResetPassword()">
        <div class="form-group">
          <label for="newPassword">New Password *</label>
          <input 
            type="password" 
            id="newPassword" 
            [(ngModel)]="newPassword" 
            name="newPassword" 
            required
            minlength="6"
            [disabled]="isLoading"
            placeholder="At least 6 characters"
            autocomplete="new-password">
          <small>Must be at least 6 characters long</small>
        </div>
        
        <div class="form-group">
          <label for="confirmPassword">Confirm Password *</label>
          <input 
            type="password" 
            id="confirmPassword" 
            [(ngModel)]="confirmPassword" 
            name="confirmPassword" 
            required
            minlength="6"
            [disabled]="isLoading"
            placeholder="Re-enter your password"
            autocomplete="new-password">
        </div>
        
        <div *ngIf="error" class="error">❌ {{error}}</div>
        <div *ngIf="success" class="success">✅ {{success}}</div>
        
        <button 
          type="submit" 
          [disabled]="isLoading || !newPassword || !confirmPassword"
          class="submit-btn">
          {{isLoading ? 'Resetting Password...' : 'Reset Password'}}
        </button>
      </form>
    </div>
  </div>
</div>
