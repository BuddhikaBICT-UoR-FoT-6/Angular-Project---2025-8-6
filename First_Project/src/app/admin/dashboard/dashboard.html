<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Dashboard</h1>
    <button class="refresh-btn" (click)="refreshData()" [disabled]="isLoading">
      <span [class.spinning]="isLoading">üîÑ</span> Refresh
    </button>
  </div>

  <div *ngIf="isLoading" class="loading">Loading dashboard data...</div>

  <div *ngIf="!isLoading" class="dashboard-content">
    <!-- Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card users">
        <div class="stat-icon">üë•</div>
        <div class="stat-info">
          <h3>{{stats.totalUsers}}</h3>
          <p>Total Users</p>
        </div>
      </div>

      <div class="stat-card products">
        <div class="stat-icon">üëï</div>
        <div class="stat-info">
          <h3>{{stats.totalProducts}}</h3>
          <p>Products</p>
        </div>
      </div>

      <div class="stat-card orders">
        <div class="stat-icon">üì¶</div>
        <div class="stat-info">
          <h3>{{stats.totalOrders}}</h3>
          <p>Total Orders</p>
        </div>
      </div>

      <div class="stat-card revenue">
        <div class="stat-icon">üí∞</div>
        <div class="stat-info">
          <h3>${{stats.totalRevenue | number:'1.2-2'}}</h3>
          <p>Revenue</p>
        </div>
      </div>

      <div class="stat-card inventory">
        <div class="stat-icon">‚ö†Ô∏è</div>
        <div class="stat-info">
          <h3>{{stats.lowStockItems}}</h3>
          <p>Low Stock Items</p>
        </div>
      </div>
    </div>

    <!-- Data Tables -->
    <div class="tables-grid">
      <!-- Recent Orders -->
      <div class="table-card">
        <h2>Recent Orders</h2>
        <div class="table-container">
          <table *ngIf="recentOrders.length > 0; else noOrders">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Customer</th>
                <th>Amount</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let order of recentOrders">
                <td>{{order._id?.slice(-6) || 'N/A'}}</td>
                <td>{{order.customerName || 'Unknown'}}</td>
                <td>${{order.total || 0 | number:'1.2-2'}}</td>
                <td><span class="status" [class]="order.status?.toLowerCase()">{{order.status || 'Pending'}}</span></td>
              </tr>
            </tbody>
          </table>
          <ng-template #noOrders>
            <p class="no-data">No recent orders</p>
          </ng-template>
        </div>
      </div>

      <!-- Top Products -->
      <div class="table-card">
        <h2>Products Overview</h2>
        <div class="table-container">
          <table *ngIf="topProducts.length > 0; else noProducts">
            <thead>
              <tr>
                <th>Product</th>
                <th>Price</th>
                <th>Category</th>
                <th>Stock</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let product of topProducts">
                <td>{{product.name || 'Unnamed Product'}}</td>
                <td>${{product.price || 0 | number:'1.2-2'}}</td>
                <td>{{product.category || 'Uncategorized'}}</td>
                <td><span [class.low-stock]="(product.stock || 0) < 10">{{product.stock || 0}}</span></td>
              </tr>
            </tbody>
          </table>
          <ng-template #noProducts>
            <p class="no-data">No products available</p>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</div>
