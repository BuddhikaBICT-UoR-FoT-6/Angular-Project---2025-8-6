<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Dashboard</h1>
    <button class="refresh-btn" (click)="refreshData()" [disabled]="isLoading">
      <span [class.spinning]="isLoading">ğŸ”„</span> Refresh
    </button>
  </div>

  <!-- Admin Navigation -->
  <div class="nav-grid" *ngIf="!isLoading">
    <a class="nav-card" routerLink="/admin/products">
      <div class="nav-title">ğŸ‘• Products</div>
      <div class="nav-sub">CRUD, images, CSV</div>
    </a>
    <a class="nav-card" routerLink="/admin/inventory">
      <div class="nav-title">ğŸ“¦ Inventory</div>
      <div class="nav-sub">Stock and low inventory</div>
    </a>
    <a class="nav-card" routerLink="/admin/users">
      <div class="nav-title">ğŸ‘¥ Users</div>
      <div class="nav-sub">Customers and admins</div>
    </a>
    <a class="nav-card" routerLink="/admin/financials">
      <div class="nav-title">ğŸ’° Financials</div>
      <div class="nav-sub">Revenue and payments</div>
    </a>
    <a class="nav-card" routerLink="/admin/orders">
      <div class="nav-title">ğŸ§¾ Orders</div>
      <div class="nav-sub">Order list and status</div>
    </a>
    <a class="nav-card" routerLink="/admin/reports">
      <div class="nav-title">ğŸ“¤ Reports & Export</div>
      <div class="nav-sub">Downloads and exports</div>
    </a>
    <a class="nav-card" routerLink="/admin/analytics">
      <div class="nav-title">ğŸ“ˆ Analytics</div>
      <div class="nav-sub">KPIs overview</div>
    </a>
    <a class="nav-card" routerLink="/admin/admin-management">
      <div class="nav-title">ğŸ›¡ï¸ Admin Management</div>
      <div class="nav-sub">Admin roles and access</div>
    </a>
  </div>

  <div *ngIf="isLoading" class="loading">Loading dashboard data...</div>

  <div *ngIf="!isLoading" class="dashboard-content">
    <!-- Stats Cards -->
    <div class="stats-grid">
      <a class="stat-card users" routerLink="/admin/users">
        <div class="stat-icon">ğŸ‘¥</div>
        <div class="stat-info">
          <h3>{{stats.totalUsers}}</h3>
          <p>Total Users</p>
        </div>
      </a>

      <a class="stat-card products" routerLink="/admin/products">
        <div class="stat-icon">ğŸ‘•</div>
        <div class="stat-info">
          <h3>{{stats.totalProducts}}</h3>
          <p>Products</p>
        </div>
      </a>

      <a class="stat-card orders" routerLink="/admin/orders">
        <div class="stat-icon">ğŸ“¦</div>
        <div class="stat-info">
          <h3>{{stats.totalOrders}}</h3>
          <p>Total Orders</p>
        </div>
      </a>

      <a class="stat-card revenue" routerLink="/admin/financials">
        <div class="stat-icon">ğŸ’°</div>
        <div class="stat-info">
          <h3>${{stats.totalRevenue | number:'1.2-2'}}</h3>
          <p>Revenue</p>
        </div>
      </a>

      <a class="stat-card inventory" routerLink="/admin/inventory">
        <div class="stat-icon">âš ï¸</div>
        <div class="stat-info">
          <h3>{{stats.lowStockItems}}</h3>
          <p>Low Stock Items</p>
        </div>
      </a>
    </div>

    <!-- Data Tables -->
    <div class="tables-grid">
      <!-- Recent Orders -->
      <div class="table-card">
        <h2>Recent Orders</h2>
        <div class="table-container">
          <table *ngIf="recentOrders.length > 0; else noOrders">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Customer</th>
                <th>Amount</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let order of recentOrders">
                <td>{{order._id?.slice(-6) || 'N/A'}}</td>
                <td>{{order.customerName || 'Unknown'}}</td>
                <td>${{order.total || 0 | number:'1.2-2'}}</td>
                <td><span class="status" [class]="order.status?.toLowerCase()">{{order.status || 'Pending'}}</span></td>
              </tr>
            </tbody>
          </table>
          <ng-template #noOrders>
            <p class="no-data">No recent orders</p>
          </ng-template>
        </div>
      </div>

      <!-- Top Products -->
      <div class="table-card">
        <h2>Products Overview</h2>
        <div class="table-container">
          <table *ngIf="topProducts.length > 0; else noProducts">
            <thead>
              <tr>
                <th>Product</th>
                <th>Price</th>
                <th>Category</th>
                <th>Stock</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let product of topProducts">
                <td>{{product.name || 'Unnamed Product'}}</td>
                <td>${{product.price || 0 | number:'1.2-2'}}</td>
                <td>{{product.category || 'Uncategorized'}}</td>
                <td><span [class.low-stock]="(product.stock || 0) < 10">{{product.stock || 0}}</span></td>
              </tr>
            </tbody>
          </table>
          <ng-template #noProducts>
            <p class="no-data">No products available</p>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</div>
